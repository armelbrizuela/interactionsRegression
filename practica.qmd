---
title: "Práctica de Interacciones"
editor: visual
editor_options: 
  chunk_output_type: console
---

Estos paquetes deben estar instalados: **haven**, **dplyr**, **tidyr**, **forcats** y **ggplot2**.

```{r}
#| eval: false
install.packages("haven")
install.packages("dplyr")
install.packages("tidyr")
install.packages("forcats")
install.packages("ggplot2")
```

Con la función `library()`, active los paquetes mencionados anteriormente.

```{r}

```

Lea el archivo de datos **ageMemory.sav** con la función `read_sav()` y guarde los datos en un objeto llamado `ageMemory`.

```{r}

```

Este archivo proviene del repositorio asociado al estudio publicado en Karsazi, Rezapour, Kormi-Nouri, Mottaghi, Abdekhodaie y Hatami (2021).

Verifique con `glimpse()` qué tipos de columnas incluye el objeto `ageMemory`.

```{r}

```

Seleccione las columnas `ZNeuroticism`, `ZOpenness`, `age`, `Zage`, `ZWorkingMemory`, `ZEpisodicComposite` y `ZWordFluency`.

```{r}

```

Elimine todas las filas en `ageMemory` que contengan al menos un dato perdido (`NA`) con `drop_na()`.

```{r}

```

Muestre los gráficos de dispersión entre todos los pares de variables con la función `pairs()`.

```{r}

```

Estime un modelo A y un modelo C. El modelo C debe incluir las interacciones entre todos los pares de predictores. El modelo A incluye todos los predictores e interacciones del modelo C y añade una interacción entre los tres predictores.

```{r}

```

Compare ambos modelos para determinar si la interacción de tres predictores mejora la capacidad predictiva del modelo.

```{r}

```

Ahora genere los resultados del modelo C con `anova()` para identificar si todos las interacciones entre pares de predictores son significativas.

```{r}

```

Veamos algunos gráficos de las interacciones para entender mejor la relación entre edad y memoria tomando en cuenta las interacciones entre los predictores.

```{r}
ageMemory$CNeuroticism <- cut(
  ageMemory$ZNeuroticism, 
  breaks = c(-Inf, -1, 1, Inf), 
  labels = c("low neuroticism", "medium neuroticism", "high neuroticism"),
  include.lowest = T)

ageMemory$COpenness <- cut(
  ageMemory$ZOpenness, 
  breaks = c(-Inf, -1, 1, Inf), 
  labels = c("low openness", "medium openness", "high openness"),
  include.lowest = T)
```

```{r}
ggplot(ageMemory) +
  aes(x = age, y = ZWorkingMemory) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = 'lm', formula = 'y ~ x', se = FALSE)
```

```{r}
ggplot(ageMemory) +
  aes(x = age, y = ZWorkingMemory) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = 'lm', formula = 'y ~ x', se = FALSE) +
  facet_wrap(facets = vars(COpenness, CNeuroticism))
```

```{r}
ageMemory |>
  mutate(opennessNeuroticism = fct_cross(COpenness, CNeuroticism)) |>
  ggplot() +
  aes(x = age, y = ZWorkingMemory) +
  geom_point(alpha = 0.5) +
  geom_smooth(
    method = 'lm', 
    formula = 'y ~ x', 
    se = FALSE, 
    aes(color = opennessNeuroticism))
```

# Referencia

Karsazi, H., Rezapour, T., Kormi-Nouri, R., Mottaghi, A., Abdekhodaie, E., & Hatami, J. (2021). The moderating effect of neuroticism and openness in the relationship between age and memory: Implications for cognitive reserve. *Personality and Individual Differences*, *176*, 110773.
